"use strict";(self["webpackChunkresearch_task_manager"]=self["webpackChunkresearch_task_manager"]||[]).push([[666],{9666:function(e,t,l){l.r(t),l.d(t,{default:function(){return ae}});var a=l(641),s=l(33),r=l(3751);const o={class:"fade-in"},n={class:"flex justify-between items-center mb-6"},d={class:"flex space-x-2 space-x-reverse"},c={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},i={class:"bg-white rounded-lg shadow-md p-6"},u={key:0,class:"text-center py-8 text-gray-500"},p={key:1,class:"space-y-4"},m={class:"font-medium text-gray-800"},k={class:"text-sm text-gray-500"},L={class:"flex items-center"},f=["href"],g=["onClick"],b={class:"mt-6"},v={class:"bg-white rounded-lg shadow-md p-6"},h={key:0,class:"text-center py-8 text-gray-500"},x={key:1,class:"space-y-4"},y={class:"font-medium text-gray-800"},C={class:"text-sm text-gray-500"},w={class:"flex items-center"},D=["href"],P=["onClick"],_={class:"mt-6"},E={class:"bg-white rounded-lg shadow-md p-6 mt-6"},K={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},M={class:"p-4 bg-gray-50 rounded-lg"},R={class:"text-2xl font-bold text-primary-600"},X={class:"p-4 bg-gray-50 rounded-lg"},A={class:"text-2xl font-bold text-primary-600"},U={class:"p-4 bg-gray-50 rounded-lg"},F={class:"text-2xl font-bold text-primary-600"},W={class:"p-4 bg-gray-50 rounded-lg"},j={class:"text-2xl font-bold text-primary-600"},T={class:"modal-content"},$={class:"flex justify-between items-center mb-4"},q={class:"mb-4"},Q={class:"flex justify-end"},V=["disabled"],B={key:0,class:"fas fa-spinner fa-spin ml-1"},I={class:"modal-content"},O={class:"flex justify-between items-center mb-4"},Z={class:"mb-4"},G={class:"flex justify-end"},S=["disabled"],z={key:0,class:"fas fa-spinner fa-spin ml-1"};function H(e,t,l,H,J,N){return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.Lk)("div",n,[t[16]||(t[16]=(0,a.Lk)("h1",{class:"text-2xl font-bold text-gray-800"},"الخطابات والموافقات",-1)),(0,a.Lk)("div",d,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=e=>H.showAddDoctorLetterModal=!0),class:"btn btn-primary ml-2"},t[14]||(t[14]=[(0,a.Lk)("i",{class:"fas fa-plus ml-2"},null,-1),(0,a.eW)("إضافة موافقة دكتور ")])),(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>H.showAddParentLetterModal=!0),class:"btn btn-secondary"},t[15]||(t[15]=[(0,a.Lk)("i",{class:"fas fa-plus ml-2"},null,-1),(0,a.eW)("إضافة موافقة ولي أمر ")]))])]),(0,a.Lk)("div",c,[(0,a.Lk)("div",i,[t[22]||(t[22]=(0,a.Lk)("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"موافقات الدكاترة",-1)),0===H.doctorLetters.length?((0,a.uX)(),(0,a.CE)("div",u," لا توجد موافقات دكاترة حتى الآن ")):((0,a.uX)(),(0,a.CE)("div",p,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(H.doctorLetters,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:"bg-gray-50 rounded-lg p-4 flex justify-between items-center"},[(0,a.Lk)("div",null,[(0,a.Lk)("h3",m,(0,s.v_)(e.name),1),(0,a.Lk)("p",k,(0,s.v_)(H.formatDate(e.timestamp)),1)]),(0,a.Lk)("div",L,[(0,a.Lk)("a",{href:e.url,target:"_blank",class:"text-primary-600 hover:text-primary-800 ml-4"},t[17]||(t[17]=[(0,a.Lk)("i",{class:"fas fa-external-link-alt ml-1"},null,-1),(0,a.eW)("عرض ")]),8,f),(0,a.Lk)("button",{onClick:t=>H.deleteLetter("doctor",e),class:"text-red-600 hover:text-red-800"},t[18]||(t[18]=[(0,a.Lk)("i",{class:"fas fa-trash-alt"},null,-1)]),8,g)])])))),128))])),(0,a.Lk)("div",b,[t[20]||(t[20]=(0,a.Lk)("h3",{class:"text-lg font-semibold text-gray-700 mb-2"},"نموذج موافقة الدكاترة",-1)),t[21]||(t[21]=(0,a.Lk)("p",{class:"text-sm text-gray-600 mb-3"}," يمكنك تنزيل نموذج موافقة الدكاترة وطباعته للحصول على موافقات جديدة. ",-1)),(0,a.Lk)("a",{href:"#",onClick:t[2]||(t[2]=(0,r.D$)(((...e)=>H.downloadDoctorTemplate&&H.downloadDoctorTemplate(...e)),["prevent"])),class:"btn btn-outline"},t[19]||(t[19]=[(0,a.Lk)("i",{class:"fas fa-download ml-2"},null,-1),(0,a.eW)("تنزيل النموذج ")]))])]),(0,a.Lk)("div",v,[t[28]||(t[28]=(0,a.Lk)("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"موافقات أولياء الأمور",-1)),0===H.parentLetters.length?((0,a.uX)(),(0,a.CE)("div",h," لا توجد موافقات أولياء أمور حتى الآن ")):((0,a.uX)(),(0,a.CE)("div",x,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(H.parentLetters,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:"bg-gray-50 rounded-lg p-4 flex justify-between items-center"},[(0,a.Lk)("div",null,[(0,a.Lk)("h3",y,(0,s.v_)(e.name),1),(0,a.Lk)("p",C,(0,s.v_)(H.formatDate(e.timestamp)),1)]),(0,a.Lk)("div",w,[(0,a.Lk)("a",{href:e.url,target:"_blank",class:"text-primary-600 hover:text-primary-800 ml-4"},t[23]||(t[23]=[(0,a.Lk)("i",{class:"fas fa-external-link-alt ml-1"},null,-1),(0,a.eW)("عرض ")]),8,D),(0,a.Lk)("button",{onClick:t=>H.deleteLetter("parent",e),class:"text-red-600 hover:text-red-800"},t[24]||(t[24]=[(0,a.Lk)("i",{class:"fas fa-trash-alt"},null,-1)]),8,P)])])))),128))])),(0,a.Lk)("div",_,[t[26]||(t[26]=(0,a.Lk)("h3",{class:"text-lg font-semibold text-gray-700 mb-2"},"نموذج موافقة أولياء الأمور",-1)),t[27]||(t[27]=(0,a.Lk)("p",{class:"text-sm text-gray-600 mb-3"}," يمكنك تنزيل نموذج موافقة أولياء الأمور وطباعته للحصول على موافقات جديدة. ",-1)),(0,a.Lk)("a",{href:"#",onClick:t[3]||(t[3]=(0,r.D$)(((...e)=>H.downloadParentTemplate&&H.downloadParentTemplate(...e)),["prevent"])),class:"btn btn-outline"},t[25]||(t[25]=[(0,a.Lk)("i",{class:"fas fa-download ml-2"},null,-1),(0,a.eW)("تنزيل النموذج ")]))])])]),(0,a.Lk)("div",E,[t[33]||(t[33]=(0,a.Lk)("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"حالة الموافقات",-1)),(0,a.Lk)("div",K,[(0,a.Lk)("div",M,[t[29]||(t[29]=(0,a.Lk)("h3",{class:"font-semibold text-gray-700 mb-2"},"إجمالي موافقات الدكاترة",-1)),(0,a.Lk)("p",R,(0,s.v_)(H.doctorLetters.length),1)]),(0,a.Lk)("div",X,[t[30]||(t[30]=(0,a.Lk)("h3",{class:"font-semibold text-gray-700 mb-2"},"إجمالي موافقات أولياء الأمور",-1)),(0,a.Lk)("p",A,(0,s.v_)(H.parentLetters.length),1)]),(0,a.Lk)("div",U,[t[31]||(t[31]=(0,a.Lk)("h3",{class:"font-semibold text-gray-700 mb-2"},"نسبة اكتمال موافقات الدكاترة",-1)),(0,a.Lk)("p",F,(0,s.v_)(H.doctorCompletionPercentage)+"%",1)]),(0,a.Lk)("div",W,[t[32]||(t[32]=(0,a.Lk)("h3",{class:"font-semibold text-gray-700 mb-2"},"نسبة اكتمال موافقات أولياء الأمور",-1)),(0,a.Lk)("p",j,(0,s.v_)(H.parentCompletionPercentage)+"%",1)])])]),H.showAddDoctorLetterModal?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"modal-overlay",onClick:t[8]||(t[8]=(0,r.D$)((e=>H.showAddDoctorLetterModal=!1),["self"]))},[(0,a.Lk)("div",T,[(0,a.Lk)("div",$,[t[35]||(t[35]=(0,a.Lk)("h2",{class:"text-xl font-bold text-gray-800"},"إضافة موافقة دكتور",-1)),(0,a.Lk)("button",{onClick:t[4]||(t[4]=e=>H.showAddDoctorLetterModal=!1),class:"text-gray-500 hover:text-gray-700"},t[34]||(t[34]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,a.Lk)("div",q,[t[36]||(t[36]=(0,a.Lk)("label",{class:"form-label"},"ملف الموافقة (PDF)",-1)),(0,a.Lk)("input",{type:"file",accept:"application/pdf",onChange:t[5]||(t[5]=(...e)=>H.handleDoctorFileUpload&&H.handleDoctorFileUpload(...e)),class:"form-input",required:""},null,32)]),(0,a.Lk)("div",Q,[(0,a.Lk)("button",{onClick:t[6]||(t[6]=e=>H.showAddDoctorLetterModal=!1),class:"btn btn-outline ml-2"},"إلغاء"),(0,a.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>H.uploadDoctorLetter&&H.uploadDoctorLetter(...e)),class:"btn btn-primary",disabled:H.isUploading},[H.isUploading?((0,a.uX)(),(0,a.CE)("i",B)):(0,a.Q3)("",!0),t[37]||(t[37]=(0,a.eW)(" رفع الملف "))],8,V)])])])):(0,a.Q3)("",!0),H.showAddParentLetterModal?((0,a.uX)(),(0,a.CE)("div",{key:1,class:"modal-overlay",onClick:t[13]||(t[13]=(0,r.D$)((e=>H.showAddParentLetterModal=!1),["self"]))},[(0,a.Lk)("div",I,[(0,a.Lk)("div",O,[t[39]||(t[39]=(0,a.Lk)("h2",{class:"text-xl font-bold text-gray-800"},"إضافة موافقة ولي أمر",-1)),(0,a.Lk)("button",{onClick:t[9]||(t[9]=e=>H.showAddParentLetterModal=!1),class:"text-gray-500 hover:text-gray-700"},t[38]||(t[38]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,a.Lk)("div",Z,[t[40]||(t[40]=(0,a.Lk)("label",{class:"form-label"},"ملف الموافقة (PDF)",-1)),(0,a.Lk)("input",{type:"file",accept:"application/pdf",onChange:t[10]||(t[10]=(...e)=>H.handleParentFileUpload&&H.handleParentFileUpload(...e)),class:"form-input",required:""},null,32)]),(0,a.Lk)("div",G,[(0,a.Lk)("button",{onClick:t[11]||(t[11]=e=>H.showAddParentLetterModal=!1),class:"btn btn-outline ml-2"},"إلغاء"),(0,a.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>H.uploadParentLetter&&H.uploadParentLetter(...e)),class:"btn btn-primary",disabled:H.isUploading},[H.isUploading?((0,a.uX)(),(0,a.CE)("i",z)):(0,a.Q3)("",!0),t[41]||(t[41]=(0,a.eW)(" رفع الملف "))],8,S)])])])):(0,a.Q3)("",!0)])}l(8111),l(1701);var J=l(953),N=l(9933),Y=l(5904),ee={name:"Letters",setup(){const e=(0,N.C3)(),t=(0,Y.c7)(),l=(0,J.KR)([]),s=(0,J.KR)([]),r=(0,J.KR)(!1),o=(0,J.KR)(!1),n=(0,J.KR)(null),d=(0,J.KR)(null),c=(0,J.KR)(!1),i=()=>{const t=(0,N.KR)(e,"doctor_letters");(0,N.Zy)(t,(e=>{const t=e.val();l.value=t?Object.entries(t).map((([e,t])=>({id:e,...t}))):[]}));const a=(0,N.KR)(e,"parent_letters");(0,N.Zy)(a,(e=>{const t=e.val();s.value=t?Object.entries(t).map((([e,t])=>({id:e,...t}))):[]}))},u=(0,a.EW)((()=>{const e=5;return Math.min(Math.round(l.value.length/e*100),100)})),p=(0,a.EW)((()=>{const e=10;return Math.min(Math.round(s.value.length/e*100),100)})),m=e=>{n.value=e.target.files[0]},k=e=>{d.value=e.target.files[0]},L=()=>{if(!n.value)return void alert("يرجى اختيار ملف");c.value=!0;const l=n.value.name,a=`doctor_letters/${l}`,s=(0,Y.KR)(t,a),o=(0,Y.bp)(s,n.value);o.on("state_changed",(e=>{const t=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+t+"% done")}),(e=>{console.error("Error uploading file:",e),c.value=!1,alert("حدث خطأ أثناء رفع الملف")}),(()=>{(0,Y.qk)(o.snapshot.ref).then((t=>{const s=(0,N.KR)(e,"doctor_letters");(0,N.VC)(s,{name:l,url:t,storagePath:a,timestamp:Date.now()}),n.value=null,c.value=!1,r.value=!1}))}))},f=()=>{if(!d.value)return void alert("يرجى اختيار ملف");c.value=!0;const l=d.value.name,a=`parent_letters/${l}`,s=(0,Y.KR)(t,a),r=(0,Y.bp)(s,d.value);r.on("state_changed",(e=>{const t=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+t+"% done")}),(e=>{console.error("Error uploading file:",e),c.value=!1,alert("حدث خطأ أثناء رفع الملف")}),(()=>{(0,Y.qk)(r.snapshot.ref).then((t=>{const s=(0,N.KR)(e,"parent_letters");(0,N.VC)(s,{name:l,url:t,storagePath:a,timestamp:Date.now()}),d.value=null,c.value=!1,o.value=!1}))}))},g=(l,a)=>{if(!confirm("هل أنت متأكد من حذف هذا الملف؟"))return;const s=(0,Y.KR)(t,a.storagePath);(0,Y.XR)(s).catch((e=>{console.error("Error deleting file:",e)}));const r=(0,N.KR)(e,`${l}_letters/${a.id}`);(0,N.TF)(r)},b=()=>{alert("سيتم تنزيل نموذج موافقة الدكاترة (هذه وظيفة تجريبية)")},v=()=>{alert("سيتم تنزيل نموذج موافقة أولياء الأمور (هذه وظيفة تجريبية)")},h=e=>{if(!e)return"";const t=new Date(e);return t.toLocaleDateString("ar-EG")};return(0,a.sV)((()=>{i()})),{doctorLetters:l,parentLetters:s,showAddDoctorLetterModal:r,showAddParentLetterModal:o,isUploading:c,doctorCompletionPercentage:u,parentCompletionPercentage:p,handleDoctorFileUpload:m,handleParentFileUpload:k,uploadDoctorLetter:L,uploadParentLetter:f,deleteLetter:g,downloadDoctorTemplate:b,downloadParentTemplate:v,formatDate:h}}},te=l(6262);const le=(0,te.A)(ee,[["render",H]]);var ae=le}}]);